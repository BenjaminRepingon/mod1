var MOD1;
(function(f){f.Map=function(d,c,e,f){this.indices=[];this.positions=[];this.normals=[];this.uvs=[];this.ground=new BABYLON.Mesh("Map",e);this.basicGround(d,c,d,c,e);this.drawMontains([[40,25,20],[20,10,70],[30,-10,70]],d);this.ground.setVerticesData(this.positions,BABYLON.VertexBuffer.PositionKind,!0);this.ground.setVerticesData(this.normals,BABYLON.VertexBuffer.NormalKind,!0);this.ground.setVerticesData(this.uvs,BABYLON.VertexBuffer.UVKind,!0);this.ground.setIndices(this.indices)};f.Map.prototype.getCustomIndex=function(d,
c,e){return 3*(d*(e+1)+c)+1};f.Map.prototype.drawMontains=function(d,c){if(0!=d.length)for(var e=d.length-1;0<=e;e--)this.interpol(d[e][0],d[e][2],d[e][1],c)};f.Map.prototype.interpol=function(d,c,e,f){e=0>e?e+1:e;firstCollision=-1;for(var g=1;g<=Math.abs(40*e);g++){for(var h=0;360>=h;h+=.3)rad=3.14159*h/180,a=Math.ceil(d+g*Math.cos(rad)),b=Math.ceil(c+g*Math.sin(rad)),index=this.getCustomIndex(a,b,f),newAltitude=e*Math.exp(-((a-d)*(a-d))/Math.abs(10*e)-(b-c)*(b-c)/Math.abs(10*e)),Math.abs(newAltitude)>
Math.abs(this.positions[index])?this.positions[index]=newAltitude:this.positions[index]>newAltitude&&1>firstCollision&&(firstCollision=0,this.positions[index]=(1.15*this.positions[index]+newAltitude)/2);firstCollision=0==firstCollision?1:firstCollision}};f.Map.prototype.basicGround=function(d,c,e,f,g){var h;for(g=0;g<=f;g++)for(h=0;h<=e;h++){var k=new BABYLON.Vector3(h*d/e-d/2,0,(f-g)*c/f-c/2),l=new BABYLON.Vector3(0,1,0);this.positions.push(k.x,k.y,k.z);this.normals.push(l.x,l.y,l.z);this.uvs.push(h/
e,1-g/f)}for(g=0;g<f;g++)for(h=0;h<e;h++)this.indices.push(h+1+(g+1)*(e+1)),this.indices.push(h+1+g*(e+1)),this.indices.push(h+g*(e+1)),this.indices.push(h+(g+1)*(e+1)),this.indices.push(h+1+(g+1)*(e+1)),this.indices.push(h+g*(e+1))}})(MOD1||(MOD1={}));(function(f){f.Core=function(d){this.scene=d};f.Core.prototype.initScene=function(){f.scene(this.scene)}})(MOD1||(MOD1={}));MOD1.scene=function(f){var d=new BABYLON.FreeCamera("camera1",new BABYLON.Vector3(0,5,-10),f);d.setTarget(BABYLON.Vector3.Zero());d.attachControl(canvas,!0);(new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(0,1,0),f)).intensity=.7;d=new MOD1.Map(100,100,f,2);d.ground.receiveShadows=!0;var c=new BABYLON.StandardMaterial("mat",f);c.diffuseColor=BABYLON.Color3.White();c.wireframe=!0;d.ground.material=c;d=BABYLON.Mesh.CreateBox("emitter0",.1,f);d.position.y=10;d.isVisible=!1;c=new BABYLON.ParticleSystem("particles",
100,f);c.particleTexture=new BABYLON.Texture("textures/flare.png",f);c.minSize=.1;c.maxSize=1;c.minLifeTime=.5;c.maxLifeTime=5;c.minEmitPower=.5;c.maxEmitPower=3;c.emitter=d;c.emitRate=10;c.blendMode=BABYLON.ParticleSystem.BLENDMODE_ONEONE;c.direction1=new BABYLON.Vector3(-1,1,-1);c.direction2=new BABYLON.Vector3(1,1,1);c.color1=new BABYLON.Color4(0,.5,1,1);c.color2=new BABYLON.Color4(0,.2,.5,1);c.gravity=new BABYLON.Vector3(0,-10,0);c.start();c.updateFunction=function(c){for(var d=0;d<c.length;d++){var f=
c[d];console.log("pok");f.position.y-.5<=ground.position.y&&(f.direction.y=0)}}};